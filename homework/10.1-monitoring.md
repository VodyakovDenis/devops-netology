# Домашнее задание к занятию 13 «Введение в мониторинг»

## Обязательные задания

1. Вас пригласили настроить мониторинг на проект. На онбординге вам рассказали, что проект представляет из себя платформу для вычислений с выдачей текстовых отчётов, которые сохраняются на диск. 
Взаимодействие с платформой осуществляется по протоколу http. Также вам отметили, что вычисления загружают ЦПУ. Какой минимальный набор метрик вы выведите в мониторинг и почему?

<details><summary>Ответ</summary>

Настройка мониторинга для проекта включает в себя выбор правильных показателей для обеспечения работоспособности, производительности и надежности системы. Учитывая, что в проекте задействована платформа для вычислений с ресурсоемкими задачами и взаимодействием по HTTP-протоколу, минимальный набор метрик, за которыми стоит следить:

**- Использование процессора:** Поскольку вычисления интенсивно используют ЦП, мониторинг использования ЦП имеет решающее значение. Высокая загрузка ЦП может указывать на потенциальные узкие места в производительности, конфликты ресурсов или необходимость оптимизации.

**- Использование памяти:** погает убедиться, что в системе достаточно памяти для эффективной обработки вычислений и HTTP-запросов. Высокое использование памяти может привести к снижению производительности или ошибкам нехватки памяти.

**- Время ответа HTTP и задержка:** необходим для взаимодействия с пользователем. Медленное время отклика может повлиять на удовлетворенность пользователей и может указывать на проблемы с производительностью платформы.

**- Частота ошибок HTTP:** (например, кодов состояния 4xx, 5xx) помогает выявить проблемы, с которыми могут столкнуться пользователи. Высокая частота ошибок может указывать на ошибки, неверные конфигурации или ограничения ресурсов.

**- Использование диска:** Поскольку текстовые отчеты сохраняются на диск, необходимо следить за использованием диска, чтобы гарантировать наличие достаточного места. Нехватка места на диске может привести к потере данных или системным сбоям.

**- Сетевой трафик:**  помогает понять схемы связи и потенциальные узкие места при передаче данных. Необычно высокий или низкий сетевой трафик может указывать на аномалии.

**- Средняя загрузка процессора:** обеспечивает более широкое представление о загрузке системы с течением времени. Высокая средняя нагрузка может указывать на периоды высокого спроса и потенциальной конкуренции за ресурсы.

**- Количество активных процессов/потоков:** дает представление о том, как система управляет одновременными вычислениями и запросами. Слишком большое количество процессов/потоков может повлиять на производительность и скорость отклика.

**- Метрики, специфичные для приложения:** В зависимости от специфики проекта может потребоваться отслеживать специфические для приложения показатели (для каждого конкретного проекта они могут быть свои).

</details>   


2. Менеджер продукта, посмотрев на ваши метрики, сказал, что ему непонятно, что такое RAM/inodes/CPUla. Также он сказал, что хочет понимать, насколько мы выполняем свои обязанности перед клиентами и какое качество обслуживания. Что вы можете ему предложить?

<details><summary>Ответ</summary>

- CPUla - средние значения загрузки процессора за 1, 5, и 15 минут. Значение не должно превышать n, где n - количество ядер.   
- inodes - индексные дескрипторы файловой системы. Имеют ограниченное количество почти во всех файловых системах. Количество свободных не должно быть, к примеру, меньше 10% от общего количества.   
- RAM - Оперативная память. Количество свободной не должно превышать 85% от доступного объёма.
- Разработать для приложения healthcheck проверки и функциональные тесты и настроить сбор их метрик. Для примера:
  - Метрики взаимодействия с пользователем (Время, Частота ошибок https)
  - Доступность и надежность услуг (Процент времени безотказной работы, Простои)
  - Мониторинг баз данных и запросы к ним, сетевой мониторинг.
  - Прочее в рамках конкреного проекта...

</details>

3. Вашей DevOps-команде в этом году не выделили финансирование на построение системы сбора логов. Разработчики, в свою очередь, хотят видеть все ошибки, которые выдают их приложения. Какое решение вы можете предпринять в этой ситуации, чтобы разработчики получали ошибки приложения?

<details><summary>Ответ</summary>

В ситуации, когда выделенная система ведения журнала не может быть построена из-за отсутствия финансирования, мы можем изучить альтернативные подходы, чтобы предоставить разработчикам информацию об ошибках приложений.   
Как вариант:

**Использовать существующие инструменты или то что можно настроить бесплатно:**
- Zabbix
- Журналы действующих приложений
- Службы объединения журналов (Elasticsearch, Logstash и Kibana (ELK))
- Платформы отслеживания ошибок (Sentry, Raygun)
- Уведомления в мессенджеры например Telegram

</details>

3. Вы, как опытный SRE, сделали мониторинг, куда вывели отображения выполнения SLA = 99% по http-кодам ответов. 
Этот параметр вычисляется по формуле: summ_2xx_requests/summ_all_requests. Он не поднимается выше 70%, но при этом в вашей системе нет кодов ответа 5xx и 4xx. Где у вас ошибка?

<details><summary>Ответ</summary>

Не учтены. 3xx - ответы, которые не являются ошибкой.   
Должно быть так: (summ_2xx_requests+summ_3xx_requests)/summ_all_requests

</details>